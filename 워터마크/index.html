<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>워터마크 웹 서비스</title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div id="sidebar">
        <ul>
            <li><a class="sideTap" href="/main.html">홈</a></li>
            <li><a class="sideTap" href="/그림판/index.html">웹 그림판</a></li>
            <li><a class="sideTap" href="/이미지 변환/index.html">확장자 변환기</a></li>
            <li><a class="sideTap" href="/simple note/index.html">웹 메모장</a></li>
            <li><a class="sideTap" href="/워터마크/index.html">워터마크</a></li>
            <li><a class="sideTap" href="/대출이자계산기/index.html">대출 이자 계산기</a></li>
            <li class="tip">
                <p>
                  팁:
                  <p >1. 이미지 파일을 업로드하고, 워터마크 텍스를 입력하세요.</p>
                  <p>2. 워터마크 텍스트를 입력한 후에 range를 설정하여 텍스트 크기를 원하는 크기로 설정하세요.</p>
                  <p>3. 워터마크 텍스트의 색상과 위치도 설정이 가능합니다.</p>
                  <p>4. 모두다 설정하셨으면, 워터마크 추가 버튼을 누르세요.</p>
                  <p>5. 미리보기 화면을 통해 원하는 위치를 설정해서 수정해보세요.</p>
                  <p>6. 모든 작업이 끝났으면 다운로드 버튼을 눌러 저장하세요.</p>
                </p>
              </li>
          </ul>
      </div>
    <h1>이미지 업로드</h1>
    <input type="file" id="inputImage">
    <br><br>
    <h1>워터마크 설정</h1>
    <input type="text" id="watermarkText" placeholder="워터마크 텍스트">
    <input type="color" id="watermarkColor" value="#000000">
    <input type="range" id="watermarkSize" min="10" max="100" step="10" value="30">
    <br>
    X: <input type="number" id="watermarkX" value="0">
    Y: <input type="number" id="watermarkY" value="0">
    <br><br>
    <h1>미리보기</h1>
    <div id="preview"></div>
    <br><br>
    <button onclick="addWatermark()">워터마크 추가</button>
    <a href="#" id="downloadLink" download="watermarked-image.png"><button>다운로드</button></a>

    <script>
      function addWatermark() {
        const inputImage = document.getElementById('inputImage');
        const watermarkText = document.getElementById('watermarkText').value;
        const watermarkColor = document.getElementById('watermarkColor').value;
        const watermarkSize = document.getElementById('watermarkSize').value;
        const watermarkX = document.getElementById('watermarkX').value;
        const watermarkY = document.getElementById('watermarkY').value;
        const preview = document.getElementById('preview');
        const downloadLink = document.getElementById('downloadLink');

        // 이미지 파일을 불러옴
        const fileReader = new FileReader();
        fileReader.readAsDataURL(inputImage.files[0]);
        fileReader.onload = function(event) {
          const image = new Image();
          image.src = event.target.result;
          image.onload = function() {
            // 캔버스에 이미지를 그림
            const canvas = document.createElement('canvas');
            canvas.width = image.width;
            canvas.height = image.height;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(image, 0, 0);
            // 워터마크를 추가
            ctx.font = `${watermarkSize}px Arial`;
            ctx.fillStyle = watermarkColor;
            ctx.fillText(watermarkText, watermarkX, watermarkY);
            // 미리보기와 다운로드 링크를 업데이트
            preview.innerHTML = '';
            preview.appendChild(canvas);
            downloadLink.href = canvas.toDataURL('image/png');
          }
        };
      }
    </script>
  </body>
</html>
